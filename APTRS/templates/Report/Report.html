{% load static %}
<html>
<head>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/4.1.0/css/bootstrap.min.css">
  <link href="{{settings.BASE_DIR}}/static/vendor/fonts/circular-std/style.css" rel="stylesheet">
  <link rel="stylesheet" href="{{settings.BASE_DIR}}/static/libs/css/style.css">
  <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.9/css/all.css">
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>

<style>

  .my-custom-button {
    color: red;
    border-color: red;
    background-color: white;
  }

  @import url('https://fonts.googleapis.com/css2?family=Open+Sans&display=swap');
  @import url('https://fonts.googleapis.com/css?family=Calibri:400,700,400italic,700italic&display=swap');
  .heading{
    color: #FF7D41;
    margin: 25px;
    padding-top: 60px;
    font-size: 25px;
  }
  .content {
    font-size: 18px;
    font-family: Calibri;
    line-height: 1.5; /* increase line spacing */
        margin: 1em 0;
  }
  .inpagecontent {
    margin-right: 35px;
    margin-left: 35px;

   
  }
  .vulnerabilitytitle{
    font-size: 50px;
    font-weight: bold;
    margin: 10px;
    color: #6e6e6e;
    text-align: left;
  }
  
  .details {
    margin-bottom: 20px;
  }
  .details h5 {
    margin-bottom: 5px;
    font-weight: bold;
  }
  .details p {
    margin-bottom: 5px;
  }
.titlediv {
  background-color: #dcddde;
  padding: 50px;
}

.vulndata {
  margin: 30px;
  font-family: Calibri;
  color: black;
  padding-top: 10px;
}
.vulnparagraph {
  font-size: 15px;
  font-family: Calibri;
  color: black;
  margin: 10px;

}

  .paragraph {
    color: black;
    font-size:40px;
    margin: 25px;
    font-family: Calibri;
  }
  .paragraph2 {
    color: black !important;
    font-size:20px;
    margin-bottom: 40px;
    font-family: 'Open Sans', sans-serif !important;
    margin-right: 25px;
    margin-left: 25px;
  }
  img {
    border: 2px solid black;
    height: 450px !important;
  width: 90% !important;
  margin: 10px;
  
  }
  .projectdetails{
    background: #2070D1;
    padding-bottom: 20px;
    padding-top: 20px;
    
  }
  .projectdetailshead{
    color: white;
    font-size:50px;
    margin: 25px;
  }
  .scopetable{
    margin: 25px;
  }
  td, tr{
    color: black;
    text-align:center;
    font-family: 'Open Sans', sans-serif;
  }
 
  .vulnpages{
    
    font-family: 'Open Sans', sans-serif;
    font-size:40px;
    color: white;
    text-align: left;
    padding: 10 15px;
    
    font-weight: bold;
    
  }
 
  
  /* Create two equal columns that floats next to each other */

  .vulntitlepagediv{
    background: #23415D;
    padding: 15px;
    height: 100px;
   } 
   .vulntitlepagediv2{
    padding: 15px;
   } 
  
  .vulnstatus{
    
    text-align:center;
    font-size:20px;
    
  }
  .vulnseverity{
 
    margin-right: 20px;
    margin-left: 10px;
    text-align:right;
    font-size:20px;
  }
  .vulnseverity2{
    
    margin-left: 50px;
    text-align:right;
    font-size:20px;
  }
  .vulntitle{
    font-family: 'Open Sans', sans-serif;
    font-size:25px;
    font-weight: bold;
    margin-top: 20px;
    margin-bottom: 20px;
    color: black;
  }
  .vulntitle2{
    font-family: 'Open Sans', sans-serif;
    font-size:20px;
    
    font-weight: bold;
    margin-top: 20px;
    margin-bottom: 20px;
    color: black;
  }



  detailsbutton {
    display: inline-block;
    margin: 30px;
  }

  .centered-div {
    margin: 20px;
    text-align: center;
  }
  
</style>
  <script>
    window.onload = function() {
      uris = "{{url}}"
      var doaminpath = uris.split('/')
    var doaminurl = doaminpath[0] +"//" +doaminpath[2]
    var arrayLength = document.getElementsByTagName("img").length
for (var i = 0; i < arrayLength; i++) {
    
 var imagepath = document.getElementsByTagName("img")[i].src;
image = imagepath.replace(/^file:\/\//i, "")
document.getElementsByTagName("img")[i].src = doaminurl + image;
//var strMessage1 = document.getElementById("helloworld").innerHTML =i
//console.log(strMessage1)
}
    //var imagepath = document.getElementsByTagName("img")[0].src
    //var basepath =  "{{settings.BASE_DIR}}"
    //console.log(imagepath)
    //var newpath = "{{settings.BASE_DIR}}" +"assets" + imagepath
    //image = imagepath.replace(/^file:\/\//i, "")
    
    
    //document.getElementsByTagName("img")[0].src = doaminurl + image;
    //var strMessage1 = document.getElementById("helloworld").innerHTML =doaminurl ;


   

    }
  </script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/2.5.0/Chart.min.js"></script>

</head>

<body style="background:white;">
  <h1 class="heading">Document History </h1>
  <div class="inpagecontent">
  <table class="table table-bordered">
    <thead class="thead-light">
      <tr>
        <th scope="col">Version</th>
        <th scope="col">Start Date</th>
        <th scope="col">End Date</th>
        <th scope="col">Prepared By</th>
      </tr>
    </thead>
    <tbody>
      <tr>
        <td>1.0</td>
        <td>{{project.startdate|date:"d/m/Y" }}</td>
        <td>{{ project.enddate|date:"d/m/Y" }}</td>
        <td>{{ project.owner.first_name }} {{ project.owner.last_name }}</td>
      </tr>



      {% if Report_type == 'Re-Audit' %}
      {% if totalretest %}
      


      {% for retest in totalretest %}
      <tr>
        <td>1.{{forloop.counter}}</td>
        <td>{{ retest.startdate|date:"d/m/Y" }}</td>
        <td>{{ retest.enddate|date:"d/m/Y" }}</td>
        <td>{{ retest.owner.first_name }}  {{ retest.owner.last_name }}</td>
      </tr>
    {% endfor %}

      {% endif %}
      {% endif %}



    </tbody>
  </table>
</div>
<h1 class="heading">Introduction </h1>
<div class="inpagecontent">
  <span class="content text-dark"> This report documents the results of a {{project.projecttype}} conducted by {{settings.ORG}} using using {{ standard|join:", " }} standards. The purpose of this test was to assess the security of the {{project.name}} and identify any vulnerabilities that could be exploited by attackers.

  The testing methodology used was designed to simulate the techniques and tactics used by real-world attackers to identify and exploit vulnerabilities. The test included a combination of automated and manual techniques, with a focus on the {{ standard|join:", " }} standards.
  
  The scope of the pentest was limited to the {{project.name}}. The testing was conducted within a controlled environment.
  
  The goal of this report is to provide a comprehensive overview of the testing methodology, findings, and recommendations for improving the security posture. This report is intended for use by the {{project.companyname.name}} team responsible for managing the security, as well as any other stakeholders who may be involved in the development or maintenance.
  </span>

</div>
<h1 class="heading">Executive Summary </h1>
<div class="inpagecontent">
  <span class="content text-dark">

    The pentest was conducted on {{project.name}} using the {{ standard|join:", " }} standards to identify vulnerabilities that could be exploited by attackers.
    The testing methodology included both manual and automated techniques to evaluate the security posture of the application.
    During the assessment, {{totalvulnerability}} vulnerabilities were identified, ranging from Informational to critical severity.
    Based on the results of the pentest, it is recommended that to address the identified vulnerabilities and improve the overall security posture of the service.
    Overall, the pentest identified several vulnerabilities that could be exploited by attackers to compromise the confidentiality, integrity, or availability of the application or underlying systems. It is recommended that the organization takes immediate action to address these vulnerabilities to reduce the risk of a successful attack.

  </span>
</div>

<div style="page-break-before:always;"></div>


<h1 class="heading">Project Scope </h1>
<div class="inpagecontent">
  <span class="content text-dark">
    The scope of the {{project.projecttype}} included the following systems and applications:
<br>
<br><br>

    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          <th scope="col">SR</th>
          <th scope="col">Scope</th>
          <th scope="col">Description</th>
        </tr>
      </thead>
      <tbody>


        {% for scope in projectscope %}
        <tr>
          <td>{{forloop.counter}}</td>
          <td>{{ scope.scope }} </td>
          <td>{{ scope.description }} </td>
        </tr>
        {% endfor %}  
  
      </tbody>
    </table>

  </span>
</div>





<h1 class="heading">Project Team  </h1>
<div class="inpagecontent">
  <span class="content text-dark">

    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          <th scope="col">Name</th>
          <th scope="col">Email</th>
          <th scope="col">Number</th>
          <th scope="col">Company</th>
        </tr>
      </thead>
      <tbody>
        {% for profiles in profile %}
        <tr>
          <td>{{profiles.user.first_name}} {{profiles.user.last_name}}</td>
          <td>{{profiles.user.email}} </td>
          <td>{{profiles.number}} </td>
          <td>{{profiles.company}}</td>
        </tr>

        {% endfor %}
  


        {% for customers in customer %}
        <tr>
            <td>{{customers.name}}</td>
            <td>{{customers.email}}</td>
            <td>{{customers.phoneNumber}}</td>
            <td>{{project.companyname.name}}</td>
        
        </tr>
        {% endfor %}


      </tbody>
    </table>
  </span>
</div>




{% if project.projectexception %}
<h1 class="heading">Project Exception </h1>
<div class="inpagecontent">
  <span class="content text-dark">
    {{project.projectexception}}
    
  </span>
</div>

{% endif %}


<div style="page-break-before:always;"></div>


<h1 class="heading">Vulnerability Summary</h1>
<div class="inpagecontent">
  <span class="content text-dark">
  
    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          <th scope="col">SR</th>
          <th scope="col">Vulnerability Name</th>
          <th scope="col">Severity</th>
          <th scope="col">Status</th>
        </tr>
      </thead>
      <tbody>
        {% for vulnerabilities in vuln %}
        <tr>
          <td>{{ forloop.counter }} </td>
          <td>{{vulnerabilities.vulnerabilityname}} </td>
          {% if vulnerabilities.vulnerabilityseverity == "Critical" %}
          <td><button type="button" class="btn text-white" style="background-color:#FF491C;font-weight: bold;" href="">{{vulnerabilities.vulnerabilityseverity}}</button></td>

          {% elif vulnerabilities.vulnerabilityseverity == "High" %}
          <td><button type="button" class="btn text-white" style="background-color:#F66E09;font-weight: bold;" href="">{{vulnerabilities.vulnerabilityseverity}}</button></td>

          {% elif vulnerabilities.vulnerabilityseverity == "Medium" %}
          <td><button type="button" class="btn text-white" style="background-color:#FBBC02;font-weight: bold;" href="">{{vulnerabilities.vulnerabilityseverity}}</button></td>

          {% elif vulnerabilities.vulnerabilityseverity == "Low" %}
          <td><button type="button" class="btn text-white" style="background-color:#20B803;font-weight: bold;" href="">{{vulnerabilities.vulnerabilityseverity}}</button></td>

          {% elif vulnerabilities.vulnerabilityseverity == "None" %}
          <td><button type="button" class="btn text-white" style="background-color:#3399FF;font-weight: bold;" href="">Informational</button></td>

          {% endif %}





          {% if vulnerabilities.status == "Vulnerable" %}
                    <td style="color: #FF0000;">{{vulnerabilities.status}}</td>

                    {% elif vulnerabilities.status == "Confirm Fixed" %}
                    <td style="color: #00FF00;">{{vulnerabilities.status}}</td>

                    {% elif vulnerabilities.status == "Accepted Risk" %}
                    <td style="color: #FFA500;">{{vulnerabilities.status}}</td>

                    {% endif %}


        </tr>

        {% endfor %}
  


      </tbody>
    </table>
    
  </span>
</div>



<div class="vulndetails"style="page-break-before:always;"><div>
  <h1 class="heading">Vulnerability Severity </h1>
  <br><br><br>
  <div class="inpagecontent">
    <span class="content text-dark">
      <div style="margin:20px;padding:20px;margin-top:100px;">
        <canvas id="myChart" style="width:100%;max-width:900px;text-align:center;"></canvas>
        </div>
    </span>
  </div>




  <div class="vulndetails"style="page-break-before:always;"></div>



{% for vulnerabilities in vuln %}

<div class="titlediv">
  <p class="vulnerabilitytitle">{{vulnerabilities.vulnerabilityname}}</p>
</div>


<div class="centered-div">


  {% if vulnerabilities.vulnerabilityseverity == "Critical" %}
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FF491C;border-color: #FF491C;font-weight: bold;font-size:20px;">{{vulnerabilities.vulnerabilityseverity}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FF491C;border-color: #FF491C;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssvector}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FF491C;border-color: #FF491C;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssscore}}</button>

  {% elif vulnerabilities.vulnerabilityseverity == "High" %}
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #F66E09;border-color: #F66E09;font-weight: bold;font-size:20px;">{{vulnerabilities.vulnerabilityseverity}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #F66E09;border-color: #F66E09;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssvector}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #F66E09;border-color: #F66E09;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssscore}}</button>

  {% elif vulnerabilities.vulnerabilityseverity == "Medium" %}
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FBBC02;border-color: #FBBC02;font-weight: bold;font-size:20px;">{{vulnerabilities.vulnerabilityseverity}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FBBC02;border-color: #FBBC02;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssvector}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FBBC02;border-color: #FBBC02;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssscore}}</button>

  {% elif vulnerabilities.vulnerabilityseverity == "Low" %}
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #20B803;border-color: #20B803;font-weight: bold;font-size:20px;">{{vulnerabilities.vulnerabilityseverity}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #20B803;border-color: #20B803;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssvector}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #20B803;border-color: #20B803;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssscore}}</button>

  {% elif vulnerabilities.vulnerabilityseverity == "None" %}
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #3399FF;border-color: #3399FF;font-weight: bold;font-size:20px;">Informational</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #3399FF;border-color: #3399FF;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssvector}}</button>
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #3399FF;border-color: #3399FF;font-weight: bold;font-size:20px;">{{vulnerabilities.cvssscore}}</button>

  {% endif %}


  {% if vulnerabilities.status == "Vulnerable" %}

  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FF0000;border-color: #FF0000;font-weight: bold;font-size:20px;">{{vulnerabilities.status}}</button>

  {% elif vulnerabilities.status == "Confirm Fixed" %}
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #00FF00;border-color: #00FF00;font-weight: bold;font-size:20px;">{{vulnerabilities.status}}</button>

  {% elif vulnerabilities.status == "Accepted Risk" %}
  <button type="button" class="detailsbutton btn-lg btn btn-outline" style="background-color:white;color: #FFA500;border-color: #FFA500;font-weight: bold;font-size:20px;">{{vulnerabilities.status}}</button>

  {% endif %}

</div>


<div class="vulndata">

  <h3>Description</h3> 
  <span class="vulnparagraph">
    {{vulnerabilities.vulnerabilitydescription|safe}}
  </span>

</div>

  <div class="vulndata">
  <h3>POC</h3> 
  <span class="vulnparagraph">
    {{vulnerabilities.POC|safe}}
  </span>
</div>

<div class="vulndata">
  <h3>Recommendation</h3> 
  <span class="vulnparagraph">
    {{vulnerabilities.vulnerabilitysolution|safe}}
  </span>
</div>

<div class="vulndata">
  <h3>Reference </h3> 
  <span class="vulnparagraph">
    {{vulnerabilities.vulnerabilityreferlnk|safe}}
  </span>
</div>


<div class="vulndata">
  <h3>Instance</h3> 
  <span class="vulnparagraph">
   

    <table class="table table-bordered">
      <thead class="thead-light">
        <tr>
          
          <th scope="col">URL</th>
          <th scope="col">Parameter</th>
          <th scope="col">Status</th>
        </tr>
      </thead>
      <tbody>
        {% for instance in instances %}
        {% if instance.vulnerabilityid.id == vulnerabilities.id %}
    <tr>
          
          <td>{{instance.URL}} </td>
          <td>{{instance.Paramter}} </td>

          {% if instance.status == "Vulnerable" %}

          <td><span  style="color: #FF0000">{{instance.status}}</span> </td>
        
          {% elif instance.status == "Confirm Fixed" %}
          <td> <span  style="color: #00FF00">{{instance.status}}</span></td>
        
          {% elif instance.status == "Accepted Risk" %}
          
          <td> <span  style="color: #FFA500">{{instance.status}}</span></td>
        
          {% endif %}

        </tr>
        {% endif %}
        {% endfor %}
      </tbody>
    </table>

  </span>
</div>





<div class="vulndetails"style="page-break-before:always;"></div>

{% endfor %}

    
  

<script>
  var xValues = ["Critical", "High", "Medium", "Low", "Informational"];
  var yValues = [{{ciritcal}}, {{high}}, {{medium}}, {{low}}, {{info}}];
  var barColors = ["#FF491C", "#F66E09","#FBBC02","#20B803","#3399FF"];
  Chart.defaults.scale.gridLines.display = false;

  var minVal = Math.min.apply(null, yValues);
  var maxVal = Math.max.apply(null, yValues);
  var yRange = (maxVal - minVal > 1) ? Math.ceil(maxVal) : 1;
  var barWidth = (maxVal - minVal <= 1) ? 0.5 : 0.8;

  new Chart("myChart", {
    type: "bar",
    data: {
      labels: xValues,
      datasets: [{
        backgroundColor: barColors,
        data: yValues
      }]
    },
    options: {
      legend: {display: false},
      title: {
        display: true,
        text: "Vulnerabilities Severity Classification"
      },
      scales: {
        yAxes: [{
          ticks: {
            min: 0,
            max: yRange,
            stepSize: (maxVal - minVal <= 1) ? 0.2 : null,
          }
        }],
      },
      plugins: {
        datalabels: {
          anchor: 'end',
          align: 'top',
          font: {
            weight: 'bold',
            size: 14,
          },
          formatter: function(value) {
            return (value === 0 || value === 1) ? value.toFixed(1) : value;
          }
        }
      },
      responsive: true,
      maintainAspectRatio: false,
      barPercentage: barWidth,
      categoryPercentage: 0.8
    }
  });
</script>

    
</body>
</html>